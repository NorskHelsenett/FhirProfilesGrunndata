<?xml version="1.0" encoding="utf-8"?>
<StructureDefinition xmlns="http://hl7.org/fhir">
  <id value="gd-registermetadata" />
  <url value="http://ehelse.no/fhir/StructureDefinition/gd-registermetadata" />
  <version value="0.1" />
  <name value="gd-registermetadata" />
  <title value="registermetadata" />
  <status value="draft" />
  <date value="2019-03-27" />
  <description value="Registermetadata describes metadata about resources available from the norwegian person index (folkeregisteret), all resources containing metadata from folkeregisteret will include registermetadata" />
  <fhirVersion value="3.0.1" />
  <kind value="complex-type" />
  <abstract value="false" />
  <contextType value="resource" />
  <context value="Patient" />
  <context value="Person" />
  <context value="Address" />
  <context value="RelatedPerson" />
  <type value="Extension" />
  <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Extension" />
  <derivation value="constraint" />
  <differential>
    <element id="Extension">
      <path value="Extension" />
      <short value="registermetadata fra folkeregisteret" />
      <definition value="Registermetadata describes metadata about resources available from the norwegian person index (folkeregisteret), all resources containing metadata from folkeregisteret will include registermetadata" />
      <base>
        <path value="Element" />
        <min value="0" />
        <max value="*" />
      </base>
      <constraint>
        <key value="ext-1" />
        <severity value="error" />
        <human value="Must have either extensions or value[x], not both" />
        <expression value="extension.exists() != value.exists()" />
        <xpath value="exists(f:extension)!=exists(f:*[starts-with(local-name(.), 'value')])" />
      </constraint>
      <mapping>
        <identity value="rim" />
        <map value="N/A" />
      </mapping>
    </element>
    <element id="Extension.extension">
      <path value="Extension.extension" />
      <slicing>
        <discriminator>
          <type value="value" />
          <path value="url" />
        </discriminator>
        <rules value="open" />
      </slicing>
    </element>
    <element id="Extension.extension:ajourholdstidspunkt">
      <path value="Extension.extension" />
      <sliceName value="ajourholdstidspunkt" />
      <short value="ajourholdstidspunkt" />
      <definition value="ajourholdstidspunkt from folkeregisteret&#xD;&#xA;&quot;Tidspunktet informasjonen ble registrert i Registeret i Folkeregisteret&quot;" />
      <max value="1" />
    </element>
    <element id="Extension.extension:ajourholdstidspunkt.url">
      <path value="Extension.extension.url" />
      <fixedUri value="ajourholdstidspunkt" />
    </element>
    <element id="Extension.extension:ajourholdstidspunkt.value[x]:valueDateTime">
      <path value="Extension.extension.valueDateTime" />
      <sliceName value="valueDateTime" />
      <type>
        <code value="dateTime" />
      </type>
    </element>
    <element id="Extension.extension:erGjeldende">
      <path value="Extension.extension" />
      <sliceName value="erGjeldende" />
      <short value="erGjeldende fra folkeregisteret" />
      <definition value="Flagg som beskriver om informasjonen er gjeldende nå-informasjon om personen. Siden opphørstidspunktet ikke blir oppdatert på &quot;gammelt&quot; element når nye verdier for et element blir registret, så vil dette bli satt til «true»/«false» når tjenesteoppslaget blir utført -  avhengig om dette er gjeldende informasjon eller ikke.&#xD;&#xA;" />
      <max value="1" />
    </element>
    <element id="Extension.extension:erGjeldende.url">
      <path value="Extension.extension.url" />
      <fixedUri value="erGjeldende" />
    </element>
    <element id="Extension.extension:erGjeldende.value[x]:valueBoolean">
      <path value="Extension.extension.valueBoolean" />
      <sliceName value="valueBoolean" />
      <type>
        <code value="boolean" />
      </type>
    </element>
    <element id="Extension.extension:kilde">
      <path value="Extension.extension" />
      <sliceName value="kilde" />
      <short value="kilde fra folkeregisteret" />
      <definition value="Kilde for informasjonen i registeret. Er angitt i tilfeller hvor det er behov for denne informasjonen i samfunnet. Hvem registeret mottok informasjon fra som gjorde at Folkeregisteret ble oppdatert, f.eks. personen selv, UDI, et sykehus osv. Kilde er et element som i noen tilfeller vil være taushetsbelagt, og som derfor må tilgangsstyres &#xD;&#xA;" />
      <max value="1" />
    </element>
    <element id="Extension.extension:kilde.url">
      <path value="Extension.extension.url" />
      <fixedUri value="kilde" />
    </element>
    <element id="Extension.extension:kilde.value[x]:valueString">
      <path value="Extension.extension.valueString" />
      <sliceName value="valueString" />
      <type>
        <code value="string" />
      </type>
    </element>
    <element id="Extension.extension:arsak">
      <path value="Extension.extension" />
      <sliceName value="arsak" />
      <short value="årsak fra folkeregisteret" />
      <definition value="Hva er årsaken til registrert informasjon. En person med personstatus = «bosatt» kan ha årsak = «født i Norge» eller «innflyttet til Norge»" />
      <max value="1" />
    </element>
    <element id="Extension.extension:arsak.url">
      <path value="Extension.extension.url" />
      <fixedUri value="arsak" />
    </element>
    <element id="Extension.extension:arsak.value[x]:valueString">
      <path value="Extension.extension.valueString" />
      <sliceName value="valueString" />
      <type>
        <code value="string" />
      </type>
    </element>
    <element id="Extension.extension:gyldighetstidspunkt">
      <path value="Extension.extension" />
      <sliceName value="gyldighetstidspunkt" />
      <short value="gyldighetstidspunkt fra folkeregisteret" />
      <definition value="Tidspunktet oppdateringen gjelder fra. I det nye Folkeregisteret må vi ha kontroll på hva vi kaller tidspunkt for ajourhold og tidspunkt registreringen gjaldt fra. F.eks. vil et fødselsnummer som er tildelt ved fødsel være gyldig fra fødselsdatoen, men kan ha blitt registrert senere i Folkeregisteret&#xD;&#xA;Personopplysninger som har historikk vil alltid ha gyldighetstidstidspunkt&#xD;&#xA;" />
      <max value="1" />
    </element>
    <element id="Extension.extension:gyldighetstidspunkt.url">
      <path value="Extension.extension.url" />
      <fixedUri value="gyldighetstidspunkt" />
    </element>
    <element id="Extension.extension:gyldighetstidspunkt.value[x]:valueDateTime">
      <path value="Extension.extension.valueDateTime" />
      <sliceName value="valueDateTime" />
      <type>
        <code value="dateTime" />
      </type>
    </element>
    <element id="Extension.extension:opphorstidspunkt">
      <path value="Extension.extension" />
      <sliceName value="opphorstidspunkt" />
      <short value="opphørstidspunkt fra folkeregisteret" />
      <definition value="Tidspunktet oppdateringen gjelder til – men ikke på&#xD;&#xA;Blir bare benyttet i tilfeller hvor opplysninger er opphørt og ikke erstattet av ny gjeldende informasjon, vil opphørstidspunktet angi tidspunktet informasjonen var gjeldende til. &#xD;&#xA;" />
      <max value="1" />
    </element>
    <element id="Extension.extension:opphorstidspunkt.url">
      <path value="Extension.extension.url" />
      <fixedUri value="opphorstidspunkt" />
    </element>
    <element id="Extension.extension:opphorstidspunkt.value[x]:valueDateTime">
      <path value="Extension.extension.valueDateTime" />
      <sliceName value="valueDateTime" />
      <type>
        <code value="dateTime" />
      </type>
    </element>
    <element id="Extension.url">
      <path value="Extension.url" />
      <fixedUri value="http://ehelse.no/fhir/StructureDefinition/gd-registermetadata" />
    </element>
    <element id="Extension.value[x]">
      <path value="Extension.value[x]" />
      <max value="0" />
    </element>
  </differential>
</StructureDefinition>